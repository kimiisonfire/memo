191029_oracle


ORACLE IF문 쓰기~~!~~!
&&, || 대신에 AND, OR 써주면됨!

  IF (MOD(V_YEAR,4)=0  AND  MOD(V_YEAR,100)<>0)  OR  MOD(V_YEAR,400)=0 THEN
    V_STR := '윤년';
  ELSE
    V_STR := '평년';
  END IF;
-------->>> 이렇게!


오늘은 반복문!!!!

LOOP, WHILE, FOR 

LOOP  :: 반드시 한번은 실행하고 그다음에 조건을 확인해서 LOOP 돌리는거임
	EXIT을 만나면 종료라서 조건이 없으면 한번만 돌아가는거임
	반복문은 주로 커서와 짝을 이루어서 쓴다네용
	오라클은 증감연산자 없다ㅏㅏ


이제 정말 커서를 합니다 <<

커서는 객체는 아님
블록구조에서 선언부에서 선언할수있는게 변수, 상수, 커서
참고로 상수는 앞에 CONSTANT가 붙으면댐

커서는 ''SELECT문의 결과집합을 다시 수동적으로 다뤄보자! 처리해보자...!'' 가 1차 목적임
결과집합의 제일첫번째부터 마지막 레코드까지 접근하는거고
이걸 하나씩 쓰는건 당연히 반복문을 쓸거임

커서 사용을 위한 단계~~~
커서 생성 -> 커서를 쓸수있도록 OPEN -> 서버에 있는걸 메모리로 한행씩 가져옴=읽어옴=FETCH
  -> FETCH이후 열어놓은 커서를 닫아! 

FOR문을 사용하면 OPEN, CLOSE를 다 생략할수있음  == 마치 향상된 FOR문같지만 더 강력스


 1) 묵시적커서 

커서의 이름을 부여해서 생성하지 않았던 쿼리 수행시에, 자동으로 생성되는 커서 = 묵시적커서
그래서 우리는 묵시적커서가 OPEN되는 순간을 볼수없음
결과가 도출되는 시점이 되자마자 OPEN됐다가 출력끝나자마자 CLOSE되니까영

커서 속성 앞에 SQL% 오면 묵시적 커서라는거임


 2) 명시적커서!!!

이름을 붙인 커서를 만들면 이제 접근할수있는겨
생성된 커서에 매개변수를 하나 설정하면, 외부로부터 뭘 하나 받는겨

DECLARE
  CURSOR CUR_EMP(C_DEPT_ID EMP.DEPARTMENT_ID%TYPE)	 ----> 매개변수 C_DEPT_ID
  IS
    SELECT EMP_NAME
      FROM EMP
     WHERE DEPARTMENT_ID = C_DEPT_ID;   -- 이 SELECT문의 결과에대한 커서 = CUR_EMP
BEGIN
  OPEN CUR_EMP(50);   	-->> 커서 오픈하고 매개변수 넣어줌!!!!!!!!!!


FETCH 명령 실행하면 커서에 저장된 제일 첫번쨰 행을 꺼내
반복문안에서 그다음행, 그다음행을 꺼내 ITERATOR처럼!!
마지막을 정해줘야하잖아 ITERATER도 HASNEXT() = TRUE일동안만 돌아가는것처럼
커서명%NOTFOUND 일때까지 돌리는거임!!!!

CURSOR 쓸거면 커서 안의 SELECT문에서 출력되는 데이터를 참고해서 변수선언해주면됨




